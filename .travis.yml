language: c++
os: linux
dist: focal

branches:
  only:
    - coverity_scan

encrypt:
  - secure: "t0B4aPR8s7wrK0wDArt3kZ+MaYhruAHS3FGih3JveLblWL8M5NyAKfPJ4D0WA9PhAuvV7Tsy0pJ+z0dIErXNwWqY696T0IgWfzgaHZfh6j+XKxUqN89r9pGLxhBBg2ZmNOFEpkuragYMXTDe15litucZDxFot7T/YaBJIsRMErwhp+Rv26KoIJnZc3oYzbF1RJadNqJIRf43d4XG3MDOGRM2z6dqgDb70cNqXNgZQgLnfWqJX5MEdK2amK+JBFzFu4o1gZKNyrp2B5az1MKYnxcrOHdANBCFNZlg/Y2kyNNXtMi/Gi4/SKAeHUDApWHWVGeK/4fDN5hDF4tT6WC8U5Z/VeJq/YDifytufWyBiUJ3WFhy7McHE43T5iqVNn6AwYu2uGT7ZH3Fy+EUPrc5fmqIZrDerIVqGI3bzWMjoj/j+24Y9WHelwH3zlM5wlSZ84Uitc5J5Rj96AfYS+A0UAS/358UAYE880rlJXiC+vvmmgqu1EAAdCORHQmXwHa8u/+MDA1Jn3M5X+F4GyxmUGw5CbYnJOP6JSJa2XJr+fYArIcSSTwwrFZIo4kAgZonuP6b7x85AZDN/EMn/j0mrN0ONOyak+f57GZ2ChMJw58vFSUXJWm09nv7gYmPLNtYhs20K92G8ZKB7OrJW3tYwW4z9OyEOPxtdos7GYr3oFk="

before_install:
  - echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-

install:
  - wget --no-check-certificate http://ftp.gnu.org/gnu/bison/bison-3.6.1.tar.gz
  - mkdir $HOME/bison
  - tar -xf bison-3.6.1.tar.gz; cd bison-3.6.1; ./configure --prefix=$HOME/bison; make -j 4 install; cd $PWD/..;
  - export PATH=$HOME/bison/bin:$PATH

addons:
  coverity_scan:
    project:
      name: taylor-santos/tuatara
      description: Compiler for the Tuatara programming language
    notification_email: taylor.p.santos@gmail.com
    build_command_prepend: mkdir build; cd build; cmake -DCMAKE_BUILD_TYPE=Debug ..
    build_command: make
    branch_pattern: coverity_scan
